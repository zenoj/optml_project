gamma=0.2, eta=0.1, lambda_=0.8, com_ratio=0.2
Rank 0, Epoch 1, Batch 0, Loss: 2.302457
x norm: 1.6586540937423706, v norm: 0.04485534504055977
h norm: 1.8132762908935547, g norm: 0.33559298515319824
Rank 1, Epoch 1, Batch 0, Loss: 2.301849
x norm: 1.6531851291656494, v norm: 0.04740827903151512
h norm: 1.8094515800476074, g norm: 0.3361184000968933
Rank 3, Epoch 1, Batch 0, Loss: 2.303338
x norm: 1.664373517036438, v norm: 0.06578276306390762
h norm: 1.8197401762008667, g norm: 0.3467126190662384
Rank 2, Epoch 1, Batch 0, Loss: 2.301651
x norm: 1.6590667963027954, v norm: 0.07748807221651077
h norm: 1.815625786781311, g norm: 0.3139670193195343
Rank 1, Epoch 1, Batch 1, Loss: 2.301300
x norm: 1.296122431755066, v norm: 0.3213063180446625
h norm: 1.5898878574371338, g norm: 0.33036887645721436
Rank 0, Epoch 1, Batch 1, Loss: 2.302493
x norm: 1.3009138107299805, v norm: 0.3434945046901703
h norm: 1.5919491052627563, g norm: 0.3522374629974365
Rank 3, Epoch 1, Batch 1, Loss: 2.303136
x norm: 1.3050140142440796, v norm: 0.33204707503318787
h norm: 1.5972800254821777, g norm: 0.3414098024368286
Rank 2, Epoch 1, Batch 1, Loss: 2.302528
x norm: 1.3000733852386475, v norm: 0.3220752477645874
h norm: 1.5955907106399536, g norm: 0.33023694157600403
Rank 0, Epoch 1, Batch 2, Loss: 2.301594
x norm: 0.9893955588340759, v norm: 0.5386826395988464
h norm: 1.2992868423461914, g norm: 0.49897024035453796
Rank 2, Epoch 1, Batch 2, Loss: 2.303123
x norm: 0.9873441457748413, v norm: 0.5235845446586609
h norm: 1.3001251220703125, g norm: 0.48926153779029846
Rank 1, Epoch 1, Batch 2, Loss: 2.302176
x norm: 0.9848758578300476, v norm: 0.5209603905677795
h norm: 1.2949484586715698, g norm: 0.47948938608169556
Rank 3, Epoch 1, Batch 2, Loss: 2.302814
x norm: 0.9917815327644348, v norm: 0.5271582007408142
h norm: 1.3040086030960083, g norm: 0.485471248626709
Rank 2, Epoch 1, Batch 3, Loss: 2.302062
x norm: 0.7527804374694824, v norm: 0.702359139919281
h norm: 1.0510705709457397, g norm: 0.6431061029434204
Rank 0, Epoch 1, Batch 3, Loss: 2.302014
x norm: 0.7558491826057434, v norm: 0.7191094160079956
h norm: 1.0519447326660156, g norm: 0.6581881046295166
Rank 3, Epoch 1, Batch 3, Loss: 2.302693
x norm: 0.7559056282043457, v norm: 0.7029712796211243
h norm: 1.0530328750610352, g norm: 0.6483060121536255
Rank 1, Epoch 1, Batch 3, Loss: 2.301787
x norm: 0.7521721720695496, v norm: 0.6915822625160217
h norm: 1.049513578414917, g norm: 0.6365810036659241
Rank 2, Epoch 1, Batch 4, Loss: 2.302351
x norm: 0.616477906703949, v norm: 0.8826015591621399
h norm: 0.8978476524353027, g norm: 0.8264106512069702
Rank 0, Epoch 1, Batch 4, Loss: 2.302636
x norm: 0.620291531085968, v norm: 0.8920861482620239
h norm: 0.8974178433418274, g norm: 0.8304616808891296
Rank 3, Epoch 1, Batch 4, Loss: 2.302457
x norm: 0.6182187795639038, v norm: 0.8709878325462341
h norm: 0.9007425308227539, g norm: 0.8114240169525146
Rank 1, Epoch 1, Batch 4, Loss: 2.302483
x norm: 0.6167660355567932, v norm: 0.8645861744880676
h norm: 0.8937024474143982, g norm: 0.805761992931366
Rank 1, Epoch 1, Batch 5, Loss: 2.302052
x norm: 0.5930732488632202, v norm: 1.0336284637451172
h norm: 0.7349497079849243, g norm: 0.9694522023200989
Rank 2, Epoch 1, Batch 5, Loss: 2.302758
x norm: 0.5917816162109375, v norm: 1.058453917503357
h norm: 0.738853931427002, g norm: 0.9952381253242493
Rank 0, Epoch 1, Batch 5, Loss: 2.302991
x norm: 0.5963281393051147, v norm: 1.0644928216934204
h norm: 0.7425888180732727, g norm: 0.9972050786018372
Rank 3, Epoch 1, Batch 5, Loss: 2.302231
x norm: 0.5917329788208008, v norm: 1.0421063899993896
h norm: 0.740339994430542, g norm: 0.9786948561668396
Rank 2, Epoch 1, Batch 6, Loss: 2.304048
x norm: 0.7020721435546875, v norm: 1.227691888809204
h norm: 0.7121062874794006, g norm: 1.1703723669052124
Rank 0, Epoch 1, Batch 6, Loss: 2.301332
x norm: 0.706303596496582, v norm: 1.2477660179138184
h norm: 0.7158573865890503, g norm: 1.1938557624816895
Rank 3, Epoch 1, Batch 6, Loss: 2.303033
x norm: 0.7006376385688782, v norm: 1.2092152833938599
h norm: 0.7124924659729004, g norm: 1.1628957986831665
Rank 1, Epoch 1, Batch 6, Loss: 2.302448
x norm: 0.7030230760574341, v norm: 1.204577922821045
h norm: 0.7120620608329773, g norm: 1.1555612087249756
Rank 3, Epoch 1, Batch 7, Loss: 2.304873
x norm: 0.8811581134796143, v norm: 1.373246431350708
h norm: 0.8236446976661682, g norm: 1.3095967769622803
Rank 0, Epoch 1, Batch 7, Loss: 2.302163
x norm: 0.8871356844902039, v norm: 1.415700078010559
h norm: 0.8277809619903564, g norm: 1.3495672941207886
Rank 1, Epoch 1, Batch 7, Loss: 2.304879
x norm: 0.8829896450042725, v norm: 1.3710577487945557
h norm: 0.8223208785057068, g norm: 1.3067803382873535
Rank 2, Epoch 1, Batch 7, Loss: 2.299554
x norm: 0.8833805918693542, v norm: 1.4177780151367188
h norm: 0.8229972124099731, g norm: 1.3538740873336792
Rank 1, Epoch 1, Batch 8, Loss: 2.301129
x norm: 1.0976818799972534, v norm: 1.5502243041992188
h norm: 0.9951856732368469, g norm: 1.4977328777313232
Rank 2, Epoch 1, Batch 8, Loss: 2.297731
x norm: 1.1002229452133179, v norm: 1.589040756225586
h norm: 0.997026264667511, g norm: 1.5308339595794678
Rank 3, Epoch 1, Batch 8, Loss: 2.302565
x norm: 1.0961800813674927, v norm: 1.5557060241699219
h norm: 0.9916713237762451, g norm: 1.5050644874572754
Rank 0, Epoch 1, Batch 8, Loss: 2.303576
x norm: 1.1028000116348267, v norm: 1.5857393741607666
h norm: 0.9968965649604797, g norm: 1.528654932975769
Rank 1, Epoch 1, Batch 9, Loss: 2.304490
x norm: 1.33506178855896, v norm: 1.721570611000061
h norm: 1.199730396270752, g norm: 1.65433931350708
Rank 2, Epoch 1, Batch 9, Loss: 2.294429
x norm: 1.338645339012146, v norm: 1.769182562828064
h norm: 1.2004815340042114, g norm: 1.70329749584198
Rank 0, Epoch 1, Batch 9, Loss: 2.299945
x norm: 1.340875506401062, v norm: 1.766047477722168
h norm: 1.2049378156661987, g norm: 1.7005116939544678
Rank 3, Epoch 1, Batch 9, Loss: 2.307022
x norm: 1.334343433380127, v norm: 1.722508192062378
h norm: 1.1978893280029297, g norm: 1.6560720205307007
Rank 3, Epoch 1, Batch 10, Loss: 2.297742
x norm: 1.5882467031478882, v norm: 1.9045920372009277
h norm: 1.4366861581802368, g norm: 1.8558677434921265
Rank 0, Epoch 1, Batch 10, Loss: 2.296733
x norm: 1.5951716899871826, v norm: 1.9391168355941772
h norm: 1.4436376094818115, g norm: 1.8858546018600464
Rank 2, Epoch 1, Batch 10, Loss: 2.304267
x norm: 1.5940090417861938, v norm: 1.9277169704437256
h norm: 1.443453073501587, g norm: 1.8722772598266602
Rank 1, Epoch 1, Batch 10, Loss: 2.304437
x norm: 1.5886527299880981, v norm: 1.8968725204467773
h norm: 1.438717246055603, g norm: 1.8473448753356934
Rank 0, Epoch 1, Batch 11, Loss: 2.310811
x norm: 1.8631845712661743, v norm: 2.1017065048217773
h norm: 1.6981201171875, g norm: 2.0322353839874268
Rank 2, Epoch 1, Batch 11, Loss: 2.306879
x norm: 1.8614670038223267, v norm: 2.0968661308288574
h norm: 1.6959584951400757, g norm: 2.028096914291382
Rank 3, Epoch 1, Batch 11, Loss: 2.304699
x norm: 1.8567992448806763, v norm: 2.071657180786133
h norm: 1.6912400722503662, g norm: 1.998753309249878
Rank 1, Epoch 1, Batch 11, Loss: 2.298703
x norm: 1.8562610149383545, v norm: 2.0765535831451416
h norm: 1.6901419162750244, g norm: 2.003986358642578
Rank 3, Epoch 1, Batch 12, Loss: 2.314171
x norm: 2.1384172439575195, v norm: 2.2354753017425537
h norm: 1.9587349891662598, g norm: 2.1836540699005127
Rank 2, Epoch 1, Batch 12, Loss: 2.305975
x norm: 2.142683744430542, v norm: 2.2719132900238037
h norm: 1.9645503759384155, g norm: 2.213380813598633
Rank 1, Epoch 1, Batch 12, Loss: 2.304018
x norm: 2.1382534503936768, v norm: 2.244831085205078
h norm: 1.9605169296264648, g norm: 2.192418098449707
Rank 0, Epoch 1, Batch 12, Loss: 2.308155
x norm: 2.1440038681030273, v norm: 2.2733638286590576
h norm: 1.9644968509674072, g norm: 2.2172834873199463
Rank 2, Epoch 1, Batch 13, Loss: 2.314561
x norm: 2.43622088432312, v norm: 2.440485954284668
h norm: 2.2514162063598633, g norm: 2.374484062194824
Rank 1, Epoch 1, Batch 13, Loss: 2.314243
x norm: 2.431623935699463, v norm: 2.4069747924804688
h norm: 2.2465178966522217, g norm: 2.336400270462036
Rank 0, Epoch 1, Batch 13, Loss: 2.308096
x norm: 2.437568187713623, v norm: 2.4473843574523926
h norm: 2.2537310123443604, g norm: 2.3802311420440674
Rank 3, Epoch 1, Batch 13, Loss: 2.298970
x norm: 2.431610107421875, v norm: 2.4165022373199463
h norm: 2.2457284927368164, g norm: 2.345346450805664
Rank 1, Epoch 1, Batch 14, Loss: 2.302869
x norm: 2.7382919788360596, v norm: 2.586446762084961
h norm: 2.5426900386810303, g norm: 2.5309860706329346
Rank 0, Epoch 1, Batch 14, Loss: 2.321790
x norm: 2.74419903755188, v norm: 2.6129066944122314
h norm: 2.549513101577759, g norm: 2.555659770965576
Rank 3, Epoch 1, Batch 14, Loss: 2.320981
x norm: 2.739161968231201, v norm: 2.5794742107391357
h norm: 2.5432443618774414, g norm: 2.5243844985961914
Rank 2, Epoch 1, Batch 14, Loss: 2.302209
x norm: 2.7429146766662598, v norm: 2.6211135387420654
h norm: 2.5479042530059814, g norm: 2.5625452995300293
Rank 2, Epoch 1, Batch 15, Loss: 2.317021
x norm: 3.064026355743408, v norm: 2.787083387374878
h norm: 2.860934019088745, g norm: 2.719367265701294
Rank 0, Epoch 1, Batch 15, Loss: 2.305104
x norm: 3.064368724822998, v norm: 2.7946083545684814
h norm: 2.8621580600738525, g norm: 2.726893186569214
Rank 3, Epoch 1, Batch 15, Loss: 2.321837
x norm: 3.0590906143188477, v norm: 2.750108003616333
h norm: 2.856750965118408, g norm: 2.678252696990967
Rank 1, Epoch 1, Batch 15, Loss: 2.308542
x norm: 3.0588691234588623, v norm: 2.7562062740325928
h norm: 2.8563804626464844, g norm: 2.6846890449523926
Rank 0, Epoch 1, Batch 16, Loss: 2.296535
x norm: 3.3986291885375977, v norm: 2.9699339866638184
h norm: 3.1901705265045166, g norm: 2.9123010635375977
Rank 2, Epoch 1, Batch 16, Loss: 2.322736
x norm: 3.398029088973999, v norm: 2.9565651416778564
h norm: 3.189267635345459, g norm: 2.89862060546875
Rank 3, Epoch 1, Batch 16, Loss: 2.326155
Rank 1, Epoch 1, Batch 16, Loss: 2.308721
x norm: 3.39192533493042, v norm: 2.9227657318115234
x norm: 3.3921968936920166, v norm: 2.9316184520721436
h norm: 3.1833834648132324, g norm: 2.868779420852661
h norm: 3.184218168258667, g norm: 2.877269744873047
Rank 0, Epoch 1, Batch 17, Loss: 2.311102
x norm: 3.7468035221099854, v norm: 3.1352379322052
h norm: 3.534475088119507, g norm: 3.0648252964019775
Rank 3, Epoch 1, Batch 17, Loss: 2.295464
x norm: 3.7387425899505615, v norm: 3.1093411445617676
h norm: 3.5268332958221436, g norm: 3.0343899726867676
Rank 1, Epoch 1, Batch 17, Loss: 2.330294
x norm: 3.7393369674682617, v norm: 3.093302011489868
h norm: 3.5259175300598145, g norm: 3.0184009075164795
Rank 2, Epoch 1, Batch 17, Loss: 2.301659
x norm: 3.74534273147583, v norm: 3.1408913135528564
h norm: 3.531310558319092, g norm: 3.0717759132385254
Rank 2, Epoch 1, Batch 18, Loss: 2.308754
x norm: 4.107859134674072, v norm: 3.3094685077667236
h norm: 3.886528968811035, g norm: 3.2514028549194336
Rank 0, Epoch 1, Batch 18, Loss: 2.339198
x norm: 4.108484268188477, v norm: 3.2997219562530518
h norm: 3.8878631591796875, g norm: 3.243744373321533
Rank 3, Epoch 1, Batch 18, Loss: 2.313366
x norm: 4.100876808166504, v norm: 3.277679920196533
h norm: 3.8786203861236572, g norm: 3.224428415298462
Rank 1, Epoch 1, Batch 18, Loss: 2.332980
x norm: 4.100368976593018, v norm: 3.2689950466156006
h norm: 3.8792340755462646, g norm: 3.2145185470581055
Rank 3, Epoch 1, Batch 19, Loss: 2.319996
x norm: 4.476889133453369, v norm: 3.4456019401550293
h norm: 4.255101680755615, g norm: 3.373368263244629
Rank 2, Epoch 1, Batch 19, Loss: 2.299376
x norm: 4.483565330505371, v norm: 3.484919309616089
h norm: 4.2592854499816895, g norm: 3.4177324771881104
Rank 0, Epoch 1, Batch 19, Loss: 2.327269
x norm: 4.4829325675964355, v norm: 3.477769374847412
h norm: 4.258820533752441, g norm: 3.4074087142944336
Rank 1, Epoch 1, Batch 19, Loss: 2.298620
x norm: 4.475489139556885, v norm: 3.4566285610198975
h norm: 4.251227378845215, g norm: 3.385481834411621
Rank 0, Epoch 1, Batch 20, Loss: 2.305510
x norm: 4.872959613800049, v norm: 3.65899658203125
h norm: 4.641862392425537, g norm: 3.5979044437408447
Rank 1, Epoch 1, Batch 20, Loss: 2.360224
x norm: 4.866184711456299, v norm: 3.60830020904541
h norm: 4.633299827575684, g norm: 3.549933433532715
Rank 2, Epoch 1, Batch 20, Loss: 2.328844
x norm: 4.874297618865967, v norm: 3.6494526863098145
h norm: 4.641475677490234, g norm: 3.588057279586792
Rank 3, Epoch 1, Batch 20, Loss: 2.327429
x norm: 4.866175651550293, v norm: 3.6216623783111572
h norm: 4.633123397827148, g norm: 3.5636258125305176
Rank 2, Epoch 1, Batch 21, Loss: 2.353742
x norm: 5.278613567352295, v norm: 3.815484046936035
h norm: 5.042389392852783, g norm: 3.7462172508239746
Rank 0, Epoch 1, Batch 21, Loss: 2.349762
x norm: 5.277978420257568, v norm: 3.815156936645508
h norm: 5.041980266571045, g norm: 3.745328426361084
Rank 3, Epoch 1, Batch 21, Loss: 2.351017
x norm: 5.271092891693115, v norm: 3.7872323989868164
h norm: 5.038350582122803, g norm: 3.7147574424743652
Rank 1, Epoch 1, Batch 21, Loss: 2.354295
x norm: 5.270149230957031, v norm: 3.780133008956909
h norm: 5.035027980804443, g norm: 3.707289218902588
Rank 3, Epoch 1, Batch 22, Loss: 2.398969
x norm: 5.689478397369385, v norm: 3.9531145095825195
h norm: 5.445655345916748, g norm: 3.8966476917266846
Rank 0, Epoch 1, Batch 22, Loss: 2.334443
x norm: 5.697249412536621, v norm: 3.9891245365142822
h norm: 5.457198143005371, g norm: 3.9293229579925537
Rank 2, Epoch 1, Batch 22, Loss: 2.379852
x norm: 5.6977105140686035, v norm: 3.984941244125366
h norm: 5.455648422241211, g norm: 3.925668239593506
Rank 1, Epoch 1, Batch 22, Loss: 2.387369
x norm: 5.688627243041992, v norm: 3.9536430835723877
h norm: 5.445732116699219, g norm: 3.8987982273101807
Rank 3, Epoch 1, Batch 23, Loss: 2.303808
x norm: 6.123533725738525, v norm: 4.131936550140381
h norm: 5.87959098815918, g norm: 4.054869651794434
Rank 1, Epoch 1, Batch 23, Loss: 2.380574
x norm: 6.122793197631836, v norm: 4.127196311950684
h norm: 5.876825332641602, g norm: 4.051602840423584
Rank 2, Epoch 1, Batch 23, Loss: 2.324519
x norm: 6.130755424499512, v norm: 4.16313362121582
h norm: 5.885674476623535, g norm: 4.092367172241211
Rank 0, Epoch 1, Batch 23, Loss: 2.425979
x norm: 6.130386829376221, v norm: 4.161201000213623
h norm: 5.884584426879883, g norm: 4.088632583618164
Rank 1, Epoch 1, Batch 24, Loss: 2.430875
x norm: 6.571783065795898, v norm: 4.301010608673096
h norm: 6.317974090576172, g norm: 4.245209217071533
Rank 3, Epoch 1, Batch 24, Loss: 2.367727
x norm: 6.572486877441406, v norm: 4.301361560821533
h norm: 6.318111419677734, g norm: 4.245235919952393
Rank 0, Epoch 1, Batch 24, Loss: 2.365180
x norm: 6.579823970794678, v norm: 4.338624477386475
h norm: 6.327239513397217, g norm: 4.2791619300842285
Rank 2, Epoch 1, Batch 24, Loss: 2.309475
x norm: 6.580058574676514, v norm: 4.3441267013549805
h norm: 6.3280744552612305, g norm: 4.283398151397705
Rank 0, Epoch 1, Batch 25, Loss: 2.407767
x norm: 7.044276714324951, v norm: 4.5100932121276855
h norm: 6.788254737854004, g norm: 4.438519477844238
Rank 1, Epoch 1, Batch 25, Loss: 2.376044
x norm: 7.036355972290039, v norm: 4.477388858795166
h norm: 6.781633377075195, g norm: 4.404916286468506
Rank 3, Epoch 1, Batch 25, Loss: 2.363048
x norm: 7.0370283126831055, v norm: 4.475231170654297
h norm: 6.783775329589844, g norm: 4.401917457580566
Rank 2, Epoch 1, Batch 25, Loss: 2.404300
x norm: 7.044714450836182, v norm: 4.508029460906982
h norm: 6.7909016609191895, g norm: 4.437605381011963
Rank 3, Epoch 1, Batch 26, Loss: 2.314506
x norm: 7.516561031341553, v norm: 4.651230335235596
h norm: 7.251551628112793, g norm: 4.592207431793213
Rank 0, Epoch 1, Batch 26, Loss: 2.349916
x norm: 7.524994850158691, v norm: 4.683803081512451
h norm: 7.262843132019043, g norm: 4.6227617263793945
Rank 2, Epoch 1, Batch 26, Loss: 2.395415
x norm: 7.5246734619140625, v norm: 4.681000232696533
Rank 1, Epoch 1, Batch 26, Loss: 2.436553
h norm: 7.2623419761657715, g norm: 4.618230819702148
x norm: 7.516499042510986, v norm: 4.6501946449279785
h norm: 7.2538533210754395, g norm: 4.591839790344238
Rank 1, Epoch 1, Batch 27, Loss: 2.398761
x norm: 8.012456893920898, v norm: 4.823464393615723
h norm: 7.74734354019165, g norm: 4.7515130043029785
Rank 0, Epoch 1, Batch 27, Loss: 2.387190
x norm: 8.02052116394043, v norm: 4.864710807800293
h norm: 7.753326416015625, g norm: 4.794400215148926
Rank 2, Epoch 1, Batch 27, Loss: 2.285462
x norm: 8.019996643066406, v norm: 4.864542484283447
h norm: 7.755300998687744, g norm: 4.794485569000244
Rank 3, Epoch 1, Batch 27, Loss: 2.413263
x norm: 8.012975692749023, v norm: 4.82642936706543
h norm: 7.748961925506592, g norm: 4.754156589508057
Rank 1, Epoch 1, Batch 28, Loss: 2.501198
x norm: 8.523656845092773, v norm: 4.998055458068848
h norm: 8.250650405883789, g norm: 4.942765235900879
Rank 0, Epoch 1, Batch 28, Loss: 2.470518
x norm: 8.533344268798828, v norm: 5.030148983001709
h norm: 8.262197494506836, g norm: 4.969439506530762
Rank 3, Epoch 1, Batch 28, Loss: 2.408535
x norm: 8.524090766906738, v norm: 5.000378131866455
h norm: 8.248927116394043, g norm: 4.944239616394043
Rank 2, Epoch 1, Batch 28, Loss: 2.487625
x norm: 8.532368659973145, v norm: 5.030050754547119
h norm: 8.260956764221191, g norm: 4.969442844390869
Rank 0, Epoch 1, Batch 29, Loss: 2.493523
x norm: 9.059980392456055, v norm: 5.205193042755127
h norm: 8.784441947937012, g norm: 5.13232421875
Rank 3, Epoch 1, Batch 29, Loss: 2.452124
x norm: 9.052530288696289, v norm: 5.170176029205322
h norm: 8.779470443725586, g norm: 5.09459114074707
Rank 1, Epoch 1, Batch 29, Loss: 2.426645
x norm: 9.051533699035645, v norm: 5.170744895935059
h norm: 8.776411056518555, g norm: 5.095892906188965
Rank 2, Epoch 1, Batch 29, Loss: 2.565527
x norm: 9.059152603149414, v norm: 5.203780651092529
h norm: 8.783077239990234, g norm: 5.132509708404541